(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[60],{74324:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/pet/create",function(){return r(83868)}])},81280:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});class a{static isEmpty(e){return!e||""===e.trim()}static isNotEmpty(e){return!a.isEmpty(e)}static valueOrEmpty(e,t){return a.isEmpty(e)?t:e}static isEmailValid(e){return!!e.trim()&&/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)}static PasswordError(e){let t="";e.length<8&&(t="Password should be at least 8 characters long");let r=/[a-z]+/.test(e);return r||(t="Password should contain at least one lowercase character"),(r=/[A-Z]+/.test(e))||(t="Password should contain at least one uppercase character"),(r=/[0-9]+/.test(e))||(t="Password should contain at least one digit"),(r=/[!@#$%^&*.?-]+/.test(e))||(t="Password should contain at least one special character"),t}}},77546:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(85893);r(67294);var i=r(25675),s=r.n(i);function n(e){var t,r,i;return e.avatar?(0,a.jsx)(s(),{unoptimized:!0,src:e.avatar,alt:"Avatar",width:90,height:90,style:{objectFit:"cover"},className:"rounded-full aspect-square ".concat(null!==(t=e.className)&&void 0!==t?t:""),onClick:e.onCLick}):(0,a.jsx)("div",{className:"aspect-square flex items-center justify-center bg-indigo-100 text-indigo-600 rounded-full text-center ".concat(null!==(r=e.textStyle)&&void 0!==r?r:"text-3xl"," font-bold ring-2 ring-indigo-500 ").concat(null!==(i=e.className)&&void 0!==i?i:""),onClick:e.onCLick,children:e.icon?e.icon:e.avatarTitle})}},31730:function(e,t,r){"use strict";var a=r(67294),i=r(33356);class s extends a.Component{constructor(...e){super(...e),this.cookies=new i.Z,this.logout=e=>{this.cookies.remove("token"),void 0!==e&&e()}}}t.Z=s},43067:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(85893),i=r(83365),s=r.n(i);function n(e){var t;let r="full"===e.width?s().btnFull:"",i=t=>{t.preventDefault(),e.onClick&&e.onClick()};return(0,a.jsx)("button",{type:e.type,className:"".concat(s().btn," ").concat(r," ").concat((()=>{if("primary"===e.variant)return e.disabled?s().btnPrimaryDisabled:s().btnPrimary;if("secondary"===e.variant)return e.disabled?s().btnSecondaryDisabled:s().btnSecondary;if("group"===e.variant){let t=e.selected?s().btnPrimary:s().btnSecondary;return"".concat(s().btnGroup," ").concat(t)}return""})()," ").concat(null!==(t=e.className)&&void 0!==t?t:""),onClick:i,disabled:e.disabled,children:e.title},e.title)}},84639:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var a=r(85893);r(67294);var i=r(81280);function s(e){return i.Z.isNotEmpty(e.message)?(0,a.jsxs)("div",{className:"p-4 mb-4 text-sm text-red-800 rounded-lg bg-red-50 dark:bg-slate-700 dark:text-red-400 ".concat(e.className?e.className:""),role:"alert",children:[(0,a.jsx)("span",{className:"font-medium",children:"Error :"})," ",e.message]}):(0,a.jsx)(a.Fragment,{})}},95546:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});var a=r(85893);r(67294);var i=r(83815),s=r.n(i);function n(e){var t;let r="full"===e.width?s().textInputFull:"",i=t=>{let r=t.currentTarget.value;e.onInput(r)};return(0,a.jsxs)("div",{className:s().textInputContainer,children:[(0,a.jsx)("label",{htmlFor:e.id,className:e.showLabel?s().label:"sr-only",children:e.placeholder}),(0,a.jsx)("input",{required:e.required,id:e.id,name:e.name,type:e.type,max:e.max,min:e.min,autoComplete:e.autoComplete,className:"".concat(s().textInput," ").concat(r," ").concat(null!==(t=e.classNames)&&void 0!==t?t:""," ").concat(e.hasError&&s().errorHighlight),placeholder:e.placeholder.replace("*",""),value:e.value,onInput:i,disabled:e.disabled,onBlur:e.onBlur,autoFocus:e.autoFocus,style:{colorScheme:"dark"}}),(0,a.jsx)("span",{className:s().errorMessage,children:e.hasError?e.errorMessage:""})]})}},94962:function(e,t,r){"use strict";var a,i;r.d(t,{e:function(){return s}}),(i=a||(a={})).M="M",i.F="F";class s{static getAll(){return Object.values(a)}static getEnum(e){return a[e]}static getTitle(e){let t;switch(e){case a.M:t="Male";break;case a.F:t="Female";break;default:t=""}return t}}},26585:function(e,t,r){"use strict";r.d(t,{H:function(){return a},U:function(){return i}});let a="petMinWeight",i="petMaxWeight"},10445:function(e,t,r){"use strict";function a(e,t){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/pet"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e.fields)})}function i(e,t){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/pet/").concat(e),{method:"GET",headers:{Authorization:"Bearer ".concat(t)}})}function s(e,t,r){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/pet/").concat(t),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e.fields)})}function n(e,t){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/pet/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})}function o(e){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/pets"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})}r.d(t,{cu:function(){return o},jL:function(){return n},lI:function(){return i},mF:function(){return s},u8:function(){return a}})},43432:function(e,t,r){"use strict";function a(e){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function i(e){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.fields)})}function s(e,t){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/user"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e.fields)})}function n(e){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/user"),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}})}function o(e){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/user"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})}function l(){return fetch("".concat("https://petjournal-app-aeqg2.ondigitalocean.app/api","/vets"),{method:"GET",headers:{"Content-Type":"application/json"}})}r.d(t,{HN:function(){return a},iD:function(){return s},l5:function(){return o},lx:function(){return i},ui:function(){return l},wB:function(){return n}})},83868:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var a=r(85893),i=r(43067);r(67294),r(79319);var s=r(95546),n=r(83815),o=r.n(n),l=r(11163),h=r(84639),c=r(81280),d=r(26585);class u{get stringify(){return JSON.stringify(this)}validate(){this.checkName(),this.checkDateOfBirth(),this.checkGender(),this.checkBreedName(),this._valid=c.Z.isEmpty(this.nameError)&&c.Z.isEmpty(this.dateOfBirthError)&&c.Z.isEmpty(this.genderError)&&c.Z.isEmpty(this.breedNameError)}get isValid(){return this._valid}get avatar(){return this._avatar}set avatar(e){this._avatar=e}get name(){return this._name}set name(e){this._name=e}get dateOfBirth(){return this._dateOfBirth}set dateOfBirth(e){this._dateOfBirth=e}get gender(){return this._gender}set gender(e){this._gender=e}get breedName(){return this._breedName}set breedName(e){this._breedName=e}get colors(){return this._colors}set colors(e){this._colors=e}get description(){return this._description}set description(e){this._description=e}get pedigree(){return this._pedigree}set pedigree(e){this._pedigree=e}get microchip(){return this._microchip}set microchip(e){this._microchip=e}get weightMin(){return Number(this._metas.get(d.H))}set weightMin(e){this._metas.set(d.H,e.toString())}get weightMax(){return Number(this._metas.get(d.U))}set weightMax(e){this._metas.set(d.U,e.toString())}get vetId(){return this._vetId}set vetId(e){this._vetId=e}get fields(){return{avatar:this._avatar,name:this._name,dateOfBirth:new Date(this._dateOfBirth).getTime(),gender:this._gender,breedName:this._breedName,colors:this._colors,description:this._description,pedigree:this._pedigree,microchip:this._microchip,vetId:this._vetId,metas:this._metas}}constructor(){this._avatar="",this._name="",this._dateOfBirth="",this._gender="",this._breedName="",this._colors=[],this._description="",this._pedigree="",this._microchip="",this._vetId="",this._metas=new Map,this.nameError="",this.dateOfBirthError="",this.genderError="",this.breedNameError="",this.hasNameError=!1,this.hasDateOfBirthError=!1,this.hasGenderError=!1,this.hasBreedNameError=!1,this._valid=!1,this.checkDateOfBirth=()=>{let e=c.Z.isEmpty(this._dateOfBirth);this.dateOfBirthError=e?"The date of birth is required":"",this.hasDateOfBirthError=e},this.checkGender=()=>{let e=c.Z.isEmpty(this._gender);this.genderError=e?"Pet gender is required":"",this.hasGenderError=e},this.checkName=()=>{let e=c.Z.isEmpty(this._name);this.nameError=e?"Name is required":"",this.hasNameError=e},this.checkBreedName=()=>{let e=c.Z.isEmpty(this._breedName);this.breedNameError=e?"Please provide a breed name":"",this.hasBreedNameError=e}}}var p=r(10445),m=r(94962),g=r(43432),f=r(5152),v=r.n(f),x=r(77546),b=r(51094),_=r(74201),N=r(31730);let y=r(68207),C=v()(()=>Promise.all([r.e(664),r.e(626)]).then(r.bind(r,62472)),{loadableGenerated:{webpack:()=>[62472]},ssr:!1});class j extends N.Z{componentDidMount(){this.getVets().catch(e=>{console.error("Could not get Vets",e),this.setState({serverError:"Could not get Vets"})})}render(){let e=this.state.vm;return(0,a.jsx)(C,{hideNav:!0,init:this.initPage,className:"bg-[url('/register-bg-dark.jpg')] bg-contain bg-center",children:(0,a.jsx)("div",{className:"container items-center mx-auto my-auto bg-white dark:bg-slate-800 max-w-sm lg:max-w-xl border rounded-md border-indigo-600",children:(0,a.jsxs)("div",{className:"shadow-sm px-4 py-4",children:[(0,a.jsx)("h2",{className:" pb-4 text-center text-3xl font-bold tracking-tight text-gray-900 dark:text-indigo-100",children:"Create a Pet profile"}),(0,a.jsxs)("form",{className:"space-y-1 mb-3",method:"POST",onSubmit:this.onSubmit,children:[(0,a.jsxs)("div",{className:"flex py-2",children:[this.state.vm.avatar&&(0,a.jsx)(b.r,{src:this.state.vm.avatar,getColors:this.getAvatarColors}),(0,a.jsx)("div",{className:"mx-auto",children:(0,a.jsx)(x.Z,{avatarTitle:"Add Image",avatar:this.state.vm.avatar,onCLick:()=>{var e;null===(e=this.imageInputRef)||void 0===e||e.click()},textStyle:"text-lg h-[90px] w-[90px]"})}),(0,a.jsx)("input",{ref:e=>this.imageInputRef=e,className:"sr-only",multiple:!1,type:"file",id:"avatar",name:"avatar",accept:"image/png, image/jpeg",onChange:this.onImageChange})]}),(0,a.jsx)(s.Z,{autoFocus:!1,id:"name",name:"name",type:"text",autoComplete:"off",required:!0,width:"full",classNames:"rounded-md",placeholder:"Name *",value:e.name,onInput:this.onNameChange,onBlur:this.checkName,hasError:e.hasNameError,errorMessage:e.nameError,showLabel:!0}),(0,a.jsx)(s.Z,{id:"dateOfBirth",name:"dateOfBirth",type:"date",max:(0,_.Z)(new Date,"yyyy-MM-dd"),autoComplete:"off",required:!0,width:"full",classNames:"rounded-md",placeholder:"Date of Birth *",value:e.dateOfBirth,onInput:this.onDateOfBirthChange,onBlur:this.checkDateOfBirth,hasError:e.hasDateOfBirthError,errorMessage:e.dateOfBirthError,showLabel:!0}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"gender",className:o().label,children:"Gender *"}),(0,a.jsxs)("select",{value:e.gender,id:"gender",name:"gender",onChange:this.onGenderChange,onBlur:this.checkGender,className:"".concat(o().textInput," ").concat(o().textInputFull," ").concat(e.hasGenderError&&o().errorHighlight," rounded-md"),children:[(0,a.jsx)("option",{value:"",children:"Choose a Gender"}),m.e.getAll().map(e=>{let t=m.e.getTitle(e);return(0,a.jsx)("option",{value:e,children:t},t)})]}),(0,a.jsx)("span",{className:o().errorMessage,children:e.hasGenderError?e.genderError:""})]}),(0,a.jsx)(s.Z,{id:"breedName",name:"breedName",type:"text",autoComplete:"off",required:!0,width:"full",classNames:"rounded-md",placeholder:"Breed Name *",value:e.breedName,onInput:this.onBreedNameChange,onBlur:this.checkBreedName,hasError:e.hasBreedNameError,errorMessage:e.breedNameError,showLabel:!0}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"colors",className:o().label,children:"Colors"}),(0,a.jsxs)("div",{className:"flex flex-row gap-2 items-center flex-wrap",children:[e.colors.map((e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{backgroundColor:e},onClick:()=>this.onRemoveColor(t),className:"rounded-full h-[35px] w-[35px] text-center text-xl font-bold ring-1 ring-slate-600",children:(0,a.jsx)("span",{style:{color:y.mostReadable(e,["#fff","#000"],{includeFallbackColors:!0}).toHexString()},className:"opacity-0 hover:opacity-100",children:e?"x":""})}),(0,a.jsx)("input",{ref:e=>this.colorsRefs[t]=e,onInput:e=>this.onColorInput(e,t),type:"color",value:e,className:"sr-only"})]},t)),this.state.vm.colors.length<10&&(0,a.jsx)("button",{type:"button",className:"bg-white text-black rounded-full h-[35px] w-[35px]",onClick:this.onAddColor,children:(0,a.jsx)("div",{className:"text-xl text-center pb-1 font-bold",children:"+"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"description",className:o().label,children:"Description"}),(0,a.jsx)("textarea",{className:"".concat(o().textInput," rounded-md w-full resize-none"),id:"description",name:"description",rows:1,placeholder:"Description",value:e.description,onInput:this.onDescriptionChange})]}),(0,a.jsx)(s.Z,{id:"microchip",name:"microchip",type:"text",autoComplete:"off",width:"full",classNames:"rounded-md",placeholder:"Microchip",value:e.microchip,onInput:this.onMicrochipChange,showLabel:!0}),(0,a.jsx)(s.Z,{id:"pedigree",name:"pedigree",type:"text",autoComplete:"off",width:"full",classNames:"rounded-md",placeholder:"Pedigree",value:e.pedigree,onInput:this.onPedigreeChange,showLabel:!0}),(0,a.jsxs)("div",{className:"w-full align-center inline-flex rounded-md shadow-sm ",children:[(0,a.jsx)(s.Z,{id:"minWeight",name:"minWeight",type:"text",autoComplete:"off",width:"full",classNames:"rounded-s-md ",placeholder:"Min Weight",value:e.weightMin?e.weightMin.toString():void 0,onInput:this.onMinWeightChange,showLabel:!0}),(0,a.jsx)(s.Z,{id:"maxWeight",name:"maxWeight",type:"text",autoComplete:"off",width:"full",classNames:"rounded-e-md",placeholder:"Max Weight",value:e.weightMax?e.weightMax.toString():void 0,onInput:this.onMaxWeightChange,showLabel:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"vetId",className:o().label,children:"Share with vet"}),(0,a.jsxs)("select",{value:e.vetId,id:"vetId",name:"vetId",onChange:this.onVetIdChange,className:"".concat(o().textInput," ").concat(o().textInputFull," ").concat(e.hasGenderError&&o().errorHighlight," rounded-md"),children:[(0,a.jsx)("option",{value:"",children:"Choose a Vet"}),this.state.vets.map(e=>(0,a.jsxs)("option",{value:e.id,children:[e.name," ",e.surname," (",e.email,")"]},e.id))]})]}),(0,a.jsx)(h.Z,{message:this.state.serverError},"errorMessage")]}),(0,a.jsxs)("div",{className:"w-full align-center inline-flex rounded-md shadow-sm gap-2",children:[(0,a.jsx)(i.Z,{variant:"secondary",type:"button",title:"Cancel",width:"full",onClick:()=>this.props.router.back()},"Cancel"),(0,a.jsx)(i.Z,{variant:"primary",type:"submit",title:"Create",width:"full",onClick:this.onSubmit},"submit")]})]})})})}constructor(e){super(e),this.colorsRefs=[],this.imageInputRef=null,this.getVets=async()=>{let e=await (0,g.ui)(),t=await e.json();if(e.ok)this.setState({vets:t.filter(e=>void 0!==e.id)});else throw Error(t.error)},this.initPage=e=>{this.setState({token:e})},this.onNameChange=e=>{let t=this.state.vm;t.name=e,this.setState({vm:t})},this.onDateOfBirthChange=e=>{let t=this.state.vm;t.dateOfBirth=e,this.setState({vm:t})},this.onGenderChange=e=>{let t=this.state.vm;t.gender=e.currentTarget.value,this.setState({vm:t})},this.onBreedNameChange=e=>{let t=this.state.vm;t.breedName=e,this.setState({vm:t})},this.onDescriptionChange=e=>{let t=this.state.vm;t.description=e.currentTarget.value,this.setState({vm:t})},this.onPedigreeChange=e=>{let t=this.state.vm;t.pedigree=e,this.setState({vm:t})},this.onMicrochipChange=e=>{let t=this.state.vm;t.microchip=e,this.setState({vm:t})},this.onMinWeightChange=e=>{let t=this.state.vm;t.weightMin=Number(e),this.setState({vm:t})},this.onMaxWeightChange=e=>{let t=this.state.vm;t.weightMax=Number(e),this.setState({vm:t})},this.onVetIdChange=e=>{let t=this.state.vm;t.vetId=e.currentTarget.value,this.setState({vm:t})},this.navigateToPetPage=e=>{this.props.router.replace("/pet/".concat(e))},this.onSubmit=async()=>{if(this.state.vm.validate(),!this.state.vm.isValid||!this.state.token){this.forceUpdate();return}let e=await (0,p.u8)(this.state.vm,this.state.token),t=await e.json();if(e.ok)this.navigateToPetPage(t.id);else if(401===e.status)this.logout(()=>this.props.router.replace("/auth/login"));else{var r;this.setState({serverError:null!==(r=t.error)&&void 0!==r?r:""})}},this.checkName=()=>{this.state.vm.checkName(),this.forceUpdate()},this.checkDateOfBirth=()=>{this.state.vm.checkDateOfBirth(),this.forceUpdate()},this.checkGender=()=>{this.state.vm.checkGender(),this.forceUpdate()},this.checkBreedName=()=>{this.state.vm.checkBreedName(),this.forceUpdate()},this.onColorInput=(e,t)=>{let r=this.state.vm.colors;r[t]=e.currentTarget.value,this.setState({vm:this.state.vm})},this.onAddColor=()=>{let e=this.state.vm.colors;e.push(""),this.setState({vm:this.state.vm},()=>{setTimeout(()=>{var e;return null===(e=this.colorsRefs[this.state.vm.colors.length-1])||void 0===e?void 0:e.click()},0)})},this.onRemoveColor=e=>{let t=this.state.vm;t.colors.splice(e,1),this.setState({vm:t})},this.onImageChange=e=>{this.uploadImage(e).catch(e=>console.error(e))},this.convertBase64=e=>new Promise((t,r)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>{t(a.result)},a.onerror=e=>{r(e)}}),this.uploadImage=async e=>{let t=e.target.files[0];try{let e=await this.convertBase64(t),r=this.state.vm;r.avatar=e,this.setState({vm:r})}catch(e){console.error(e)}},this.getAvatarColors=e=>{let t=this.state.vm;t.colors=t.colors.filter(e=>!this.state.avatarColors.includes(e)),t.colors.push(...e),this.setState({vm:t,avatarColors:e})},this.state={vm:new u,vets:[],focusColor:!1,avatarColors:[]}}}var w=(0,l.withRouter)(j)},83365:function(e){e.exports={btn:"button_btn__w__d1",btnFull:"button_btnFull__Q8iU8",btnPrimary:"button_btnPrimary__b_fGY",btnSecondary:"button_btnSecondary__Vaxi0",btnGroup:"button_btnGroup__zeRjm",btnPrimaryDisabled:"button_btnPrimaryDisabled__9IQhk",btnSecondaryDisabled:"button_btnSecondaryDisabled__eLBdY"}},83815:function(e){e.exports={textInput:"textInput_textInput__rwYXO",textInputText:"textInput_textInputText__RbFSM",label:"textInput_label__IpSov",textInputFull:"textInput_textInputFull__BtdFB",errorHighlight:"textInput_errorHighlight__6WM_d",errorMessage:"textInput_errorMessage__2Uw_U",textInputContainer:"textInput_textInputContainer__hcS5_",phoneInput:"textInput_phoneInput__ILwRV",phoneInputFull:"textInput_phoneInputFull__VL9NH"}}},function(e){e.O(0,[675,706,961,201,126,255,94,774,888,179],function(){return e(e.s=74324)}),_N_E=e.O()}]);